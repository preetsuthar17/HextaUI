{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "ai-usage-quota",
  "type": "registry:component",
  "title": "AI Usage Quota",
  "description": "Display AI usage statistics, rate limits, and quota information.",
  "registryDependencies": ["alert", "badge", "card", "progress", "tooltip"],
  "files": [
    {
      "path": "registry/new-york/blocks/ai/ai-usage-quota.tsx",
      "content": "\"use client\";\n\nimport { AlertTriangle, Clock, TrendingUp, Zap } from \"lucide-react\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface TokenUsage {\n  input: number;\n  output: number;\n  total: number;\n}\n\nexport interface RateLimit {\n  remaining: number;\n  limit: number;\n  resetAt?: Date;\n  window: \"minute\" | \"hour\" | \"day\" | \"month\";\n}\n\nexport interface Quota {\n  used: number;\n  limit: number;\n  resetAt?: Date;\n  period: \"day\" | \"month\" | \"year\";\n}\n\nexport interface AIUsageQuotaProps {\n  tokenUsage?: TokenUsage;\n  rateLimit?: RateLimit;\n  quota?: Quota;\n  onUpgrade?: () => void;\n  className?: string;\n  showUpgradePrompt?: boolean;\n  upgradeThreshold?: number;\n}\n\nfunction formatNumber(num: number): string {\n  if (num >= 1_000_000) {\n    return `${(num / 1_000_000).toFixed(1)}M`;\n  }\n  if (num >= 1000) {\n    return `${(num / 1000).toFixed(1)}K`;\n  }\n  return num.toLocaleString();\n}\n\nfunction formatTimeUntil(date: Date): string {\n  const now = new Date();\n  const diff = date.getTime() - now.getTime();\n\n  if (diff <= 0) return \"Now\";\n\n  const minutes = Math.floor(diff / 60_000);\n  const hours = Math.floor(diff / 3_600_000);\n  const days = Math.floor(diff / 86_400_000);\n\n  if (days > 0) return `${days}d`;\n  if (hours > 0) return `${hours}h`;\n  if (minutes > 0) return `${minutes}m`;\n  return \"Soon\";\n}\n\nfunction formatTime(date: Date): string {\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const hour12 = hours % 12 || 12;\n  const ampm = hours >= 12 ? \"PM\" : \"AM\";\n  const minutesStr = minutes.toString().padStart(2, \"0\");\n  return `${hour12}:${minutesStr} ${ampm}`;\n}\n\nfunction formatDateTime(date: Date): string {\n  const months = [\n    \"Jan\",\n    \"Feb\",\n    \"Mar\",\n    \"Apr\",\n    \"May\",\n    \"Jun\",\n    \"Jul\",\n    \"Aug\",\n    \"Sep\",\n    \"Oct\",\n    \"Nov\",\n    \"Dec\",\n  ];\n  const month = months[date.getMonth()];\n  const day = date.getDate();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const hour12 = hours % 12 || 12;\n  const ampm = hours >= 12 ? \"PM\" : \"AM\";\n  const minutesStr = minutes.toString().padStart(2, \"0\");\n  return `${month} ${day}, ${hour12}:${minutesStr} ${ampm}`;\n}\n\ninterface TimeUntilProps {\n  date: Date;\n  className?: string;\n}\n\nfunction TimeUntil({ date, className }: TimeUntilProps) {\n  const [timeUntil, setTimeUntil] = useState(() => formatTimeUntil(date));\n\n  useEffect(() => {\n    const updateTime = () => {\n      setTimeUntil(formatTimeUntil(date));\n    };\n\n    const timeoutId = setTimeout(updateTime, 0);\n    const interval = setInterval(updateTime, 60_000);\n\n    return () => {\n      clearTimeout(timeoutId);\n      clearInterval(interval);\n    };\n  }, [date]);\n\n  return <span className={className}>{timeUntil}</span>;\n}\n\ninterface TokenUsageDisplayProps {\n  tokenUsage: TokenUsage;\n}\n\nfunction TokenUsageDisplay({ tokenUsage }: TokenUsageDisplayProps) {\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"font-medium text-sm\">Token Usage</h3>\n        <Badge className=\"font-mono text-xs\" variant=\"outline\">\n          {formatNumber(tokenUsage.total)}\n        </Badge>\n      </div>\n      <div className=\"flex flex-col gap-2\">\n        <div className=\"flex items-center justify-between text-muted-foreground text-xs\">\n          <div className=\"flex items-center gap-1.5\">\n            <TrendingUp className=\"size-3\" />\n            <span>Input</span>\n          </div>\n          <span className=\"font-mono tabular-nums\">\n            {formatNumber(tokenUsage.input)}\n          </span>\n        </div>\n        <div className=\"flex items-center justify-between text-muted-foreground text-xs\">\n          <div className=\"flex items-center gap-1.5\">\n            <Zap className=\"size-3\" />\n            <span>Output</span>\n          </div>\n          <span className=\"font-mono tabular-nums\">\n            {formatNumber(tokenUsage.output)}\n          </span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface RateLimitIndicatorProps {\n  rateLimit: RateLimit;\n}\n\nfunction RateLimitIndicator({ rateLimit }: RateLimitIndicatorProps) {\n  const percentage = (rateLimit.remaining / rateLimit.limit) * 100;\n  const isLow = percentage < 20;\n  const isWarning = percentage < 50;\n\n  const windowLabel = {\n    minute: \"min\",\n    hour: \"hr\",\n    day: \"day\",\n    month: \"mo\",\n  }[rateLimit.window];\n\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"font-medium text-sm\">Rate Limit</h3>\n        <Badge\n          className={cn(\n            \"font-mono text-xs\",\n            isLow && \"border-destructive/50 bg-destructive/10 text-destructive\"\n          )}\n          variant={isLow ? \"destructive\" : isWarning ? \"outline\" : \"secondary\"}\n        >\n          {rateLimit.remaining}/{rateLimit.limit}\n        </Badge>\n      </div>\n      <div className=\"flex flex-col gap-2\">\n        <Progress\n          aria-label={`${rateLimit.remaining} of ${rateLimit.limit} requests remaining`}\n          className=\"h-2\"\n          value={percentage}\n        />\n        <div className=\"flex items-center justify-between text-muted-foreground text-xs\">\n          <div className=\"flex items-center gap-1.5\">\n            <Clock className=\"size-3\" />\n            <span>Per {windowLabel}</span>\n          </div>\n          {rateLimit.resetAt && (\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <span className=\"cursor-help\">\n                  Resets in <TimeUntil date={rateLimit.resetAt} />\n                </span>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>Resets at {formatTime(rateLimit.resetAt)}</p>\n              </TooltipContent>\n            </Tooltip>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface QuotaProgressProps {\n  quota: Quota;\n}\n\nfunction QuotaProgress({ quota }: QuotaProgressProps) {\n  const percentage = (quota.used / quota.limit) * 100;\n  const isLow = percentage >= 90;\n  const isWarning = percentage >= 75;\n\n  const periodLabel = {\n    day: \"Daily\",\n    month: \"Monthly\",\n    year: \"Yearly\",\n  }[quota.period];\n\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"font-medium text-sm\">{periodLabel} Quota</h3>\n        <Badge\n          className={cn(\n            \"font-mono text-xs\",\n            isLow && \"border-destructive/50 bg-destructive/10 text-destructive\"\n          )}\n          variant={isLow ? \"destructive\" : isWarning ? \"outline\" : \"secondary\"}\n        >\n          {formatNumber(quota.used)}/{formatNumber(quota.limit)}\n        </Badge>\n      </div>\n      <div className=\"flex flex-col gap-2\">\n        <Progress\n          aria-label={`${quota.used} of ${quota.limit} tokens used`}\n          className={cn(\n            \"h-2\",\n            isLow && \"[&>div]:bg-destructive\",\n            isWarning && !isLow && \"[&>div]:bg-yellow-500\"\n          )}\n          value={percentage}\n        />\n        <div className=\"flex items-center justify-between text-muted-foreground text-xs\">\n          <span>{percentage.toFixed(1)}% used</span>\n          {quota.resetAt && (\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <span className=\"flex cursor-help items-center gap-1\">\n                  <Clock className=\"size-3\" />\n                  <span>\n                    Resets in <TimeUntil date={quota.resetAt} />\n                  </span>\n                </span>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>Resets at {formatDateTime(quota.resetAt)}</p>\n              </TooltipContent>\n            </Tooltip>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface UpgradePromptProps {\n  message?: string;\n}\n\nfunction UpgradePrompt({ message }: UpgradePromptProps) {\n  return (\n    <Alert className=\"rounded-xl border-primary/20 bg-primary/5\">\n      <AlertTriangle className=\"size-4 text-primary\" />\n      <AlertTitle className=\"text-sm\">Usage Warning!</AlertTitle>\n      <AlertDescription className=\"flex items-center justify-between gap-2\">\n        <span className=\"text-muted-foreground text-xs\">\n          {message ||\n            \"You're approaching your usage limits. Upgrade to continue using HextaAI without interruptions.\"}\n        </span>\n      </AlertDescription>\n    </Alert>\n  );\n}\n\nexport default function AIUsageQuota({\n  tokenUsage,\n  rateLimit,\n  quota,\n  onUpgrade,\n  className,\n  showUpgradePrompt = true,\n  upgradeThreshold = 80,\n}: AIUsageQuotaProps) {\n  const shouldShowUpgrade = useMemo(() => {\n    if (!showUpgradePrompt) return false;\n\n    const quotaPercentage = quota ? (quota.used / quota.limit) * 100 : 0;\n    const rateLimitPercentage = rateLimit\n      ? ((rateLimit.limit - rateLimit.remaining) / rateLimit.limit) * 100\n      : 0;\n\n    return (\n      quotaPercentage >= upgradeThreshold ||\n      rateLimitPercentage >= upgradeThreshold\n    );\n  }, [quota, rateLimit, showUpgradePrompt, upgradeThreshold]);\n\n  const hasAnyData = tokenUsage || rateLimit || quota;\n\n  if (!hasAnyData) {\n    return null;\n  }\n\n  return (\n    <TooltipProvider>\n      {shouldShowUpgrade && (\n        <UpgradePrompt\n          message={\n            quota && (quota.used / quota.limit) * 100 >= upgradeThreshold\n              ? `You've used ${((quota.used / quota.limit) * 100).toFixed(0)}% of your ${quota.period}ly quota. Upgrade to get more tokens.`\n              : rateLimit &&\n                  ((rateLimit.limit - rateLimit.remaining) / rateLimit.limit) *\n                    100 >=\n                    upgradeThreshold\n                ? `You've used ${(((rateLimit.limit - rateLimit.remaining) / rateLimit.limit) * 100).toFixed(0)}% of your rate limit. Upgrade for higher limits.`\n                : undefined\n          }\n        />\n      )}\n\n      <div className={cn(\"flex w-full flex-col gap-4\", className)}>\n        <Card className=\"gap-2 p-4 shadow-xs md:p-6\">\n          <CardHeader className=\"p-0\">\n            <CardTitle className=\"p-0 text-base\">Usage & Quota</CardTitle>\n          </CardHeader>\n          <CardContent className=\"flex flex-col gap-6 p-0\">\n            {tokenUsage && <TokenUsageDisplay tokenUsage={tokenUsage} />}\n            {rateLimit && <RateLimitIndicator rateLimit={rateLimit} />}\n            {quota && <QuotaProgress quota={quota} />}\n          </CardContent>\n        </Card>\n      </div>\n    </TooltipProvider>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}
