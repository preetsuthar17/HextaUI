{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "auth-two-factor-verify",
  "type": "registry:ui",
  "title": "Auth Two Factor Verify",
  "description": "Verify two-factor authentication code or recovery code.",
  "registryDependencies": [
    "button",
    "card",
    "field",
    "input-group",
    "input-otp",
    "separator"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/auth/auth-two-factor-verify.tsx",
      "content": "\"use client\";\n\nimport { Loader2, RefreshCw, Shield, ShieldCheck } from \"lucide-react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/registry/new-york/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/registry/new-york/ui/card\";\nimport {\n  Field,\n  FieldContent,\n  FieldError,\n  FieldLabel,\n} from \"@/registry/new-york/ui/field\";\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupInput,\n} from \"@/registry/new-york/ui/input-group\";\nimport {\n  InputOTP,\n  InputOTPGroup,\n  InputOTPSlot,\n} from \"@/registry/new-york/ui/input-otp\";\nimport { Separator } from \"@/registry/new-york/ui/separator\";\n\nexport interface AuthTwoFactorVerifyProps {\n  onSubmit?: (code: string) => void;\n  onRecoveryCode?: (code: string) => void;\n  onResend?: () => void;\n  className?: string;\n  isLoading?: boolean;\n  resendCooldown?: number; // seconds\n  errors?: {\n    code?: string;\n    recoveryCode?: string;\n    general?: string;\n  };\n  autoSubmit?: boolean;\n}\n\nexport default function AuthTwoFactorVerify({\n  onSubmit,\n  onRecoveryCode,\n  onResend,\n  className,\n  isLoading = false,\n  resendCooldown = 60,\n  errors,\n  autoSubmit = true,\n}: AuthTwoFactorVerifyProps) {\n  const [code, setCode] = useState(\"\");\n  const [recoveryCode, setRecoveryCode] = useState(\"\");\n  const [useRecoveryCode, setUseRecoveryCode] = useState(false);\n  const [cooldown, setCooldown] = useState(0);\n\n  useEffect(() => {\n    if (cooldown > 0) {\n      const timer = setTimeout(() => {\n        setCooldown((prev) => prev - 1);\n      }, 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [cooldown]);\n\n  useEffect(() => {\n    if (autoSubmit && code.length === 6 && !isLoading && !useRecoveryCode) {\n      onSubmit?.(code);\n    }\n  }, [code, autoSubmit, isLoading, useRecoveryCode, onSubmit]);\n\n  const handleResend = useCallback(async () => {\n    if (cooldown > 0) return;\n    await onResend?.();\n    setCooldown(resendCooldown);\n  }, [cooldown, onResend, resendCooldown]);\n\n  const handleRecoveryCodeSubmit = useCallback(\n    (e: React.FormEvent) => {\n      e.preventDefault();\n      if (recoveryCode.trim()) {\n        onRecoveryCode?.(recoveryCode.trim());\n      }\n    },\n    [recoveryCode, onRecoveryCode]\n  );\n\n  const codeError = errors?.code;\n  const recoveryCodeError = errors?.recoveryCode;\n  const generalError = errors?.general;\n\n  return (\n    <Card className={cn(\"w-full shadow-xs\", className)}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Shield className=\"size-5\" />\n          Verify two-factor authentication\n        </CardTitle>\n        <CardDescription>\n          Enter the 6-digit code from your authenticator app\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"flex flex-col gap-6\">\n          {generalError && (\n            <div\n              aria-live=\"polite\"\n              className=\"rounded-lg border border-destructive/50 bg-destructive/10 p-3 text-destructive text-sm\"\n              role=\"alert\"\n            >\n              {generalError}\n            </div>\n          )}\n\n          {useRecoveryCode ? (\n            <form\n              className=\"flex flex-col gap-4\"\n              onSubmit={handleRecoveryCodeSubmit}\n            >\n              <Field data-invalid={!!recoveryCodeError}>\n                <FieldLabel htmlFor=\"recovery-code\">\n                  Recovery code\n                  <span aria-label=\"required\" className=\"text-destructive\">\n                    *\n                  </span>\n                </FieldLabel>\n                <FieldContent>\n                  <InputGroup aria-invalid={!!recoveryCodeError}>\n                    <InputGroupAddon>\n                      <ShieldCheck className=\"size-4\" />\n                    </InputGroupAddon>\n                    <InputGroupInput\n                      aria-describedby={\n                        recoveryCodeError ? \"recovery-code-error\" : undefined\n                      }\n                      aria-invalid={!!recoveryCodeError}\n                      autoComplete=\"one-time-code\"\n                      id=\"recovery-code\"\n                      name=\"recoveryCode\"\n                      onChange={(e) => setRecoveryCode(e.target.value)}\n                      placeholder=\"Enter recovery code\"\n                      required\n                      type=\"text\"\n                      value={recoveryCode}\n                    />\n                  </InputGroup>\n                  {recoveryCodeError && (\n                    <FieldError id=\"recovery-code-error\">\n                      {recoveryCodeError}\n                    </FieldError>\n                  )}\n                </FieldContent>\n              </Field>\n\n              <div className=\"flex flex-col gap-2 sm:flex-row\">\n                <Button\n                  aria-busy={isLoading}\n                  className=\"w-full sm:w-auto\"\n                  data-loading={isLoading}\n                  disabled={isLoading || !recoveryCode.trim()}\n                  type=\"submit\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"size-4 animate-spin\" />\n                      Verifyingâ€¦\n                    </>\n                  ) : (\n                    <>\n                      <ShieldCheck className=\"size-4\" />\n                      Verify recovery code\n                    </>\n                  )}\n                </Button>\n                <Button\n                  className=\"w-full sm:w-auto\"\n                  onClick={() => {\n                    setUseRecoveryCode(false);\n                    setRecoveryCode(\"\");\n                  }}\n                  type=\"button\"\n                  variant=\"outline\"\n                >\n                  Use authenticator code\n                </Button>\n              </div>\n            </form>\n          ) : (\n            <div className=\"flex flex-col gap-4\">\n              <Field data-invalid={!!codeError}>\n                <FieldLabel htmlFor=\"2fa-code\">\n                  Authentication code\n                  <span aria-label=\"required\" className=\"text-destructive\">\n                    *\n                  </span>\n                </FieldLabel>\n                <FieldContent>\n                  <InputOTP\n                    aria-describedby={codeError ? \"2fa-code-error\" : undefined}\n                    aria-invalid={!!codeError}\n                    disabled={isLoading}\n                    id=\"2fa-code\"\n                    maxLength={6}\n                    onChange={setCode}\n                    value={code}\n                  >\n                    <InputOTPGroup>\n                      <InputOTPSlot index={0} />\n                      <InputOTPSlot index={1} />\n                      <InputOTPSlot index={2} />\n                      <InputOTPSlot index={3} />\n                      <InputOTPSlot index={4} />\n                      <InputOTPSlot index={5} />\n                    </InputOTPGroup>\n                  </InputOTP>\n                  {codeError && (\n                    <FieldError id=\"2fa-code-error\">{codeError}</FieldError>\n                  )}\n                  <div className=\"flex flex-col gap-2 text-muted-foreground text-xs sm:flex-row sm:items-center sm:justify-between\">\n                    <span>Enter the 6-digit code from your app</span>\n                    {onResend && (\n                      <button\n                        className=\"self-start rounded-sm hover:text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 sm:self-auto\"\n                        disabled={cooldown > 0 || isLoading}\n                        onClick={handleResend}\n                        type=\"button\"\n                      >\n                        {cooldown > 0 ? (\n                          `Resend in ${cooldown}s`\n                        ) : (\n                          <span className=\"flex items-center gap-1\">\n                            <RefreshCw className=\"size-3\" />\n                            Resend code\n                          </span>\n                        )}\n                      </button>\n                    )}\n                  </div>\n                </FieldContent>\n              </Field>\n\n              {onRecoveryCode && (\n                <>\n                  <div className=\"relative\">\n                    <Separator />\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <span className=\"bg-background px-2 text-muted-foreground text-xs\">\n                        Or\n                      </span>\n                    </div>\n                  </div>\n\n                  <Button\n                    onClick={() => setUseRecoveryCode(true)}\n                    type=\"button\"\n                    variant=\"ghost\"\n                  >\n                    Use recovery code instead\n                  </Button>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n",
      "type": "registry:ui"
    }
  ]
}
