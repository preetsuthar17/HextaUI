{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "auth-change-password",
  "type": "registry:ui",
  "title": "Auth Change Password",
  "description": "Change password with current and new password fields.",
  "registryDependencies": ["button", "card", "field", "input-group"],
  "files": [
    {
      "path": "registry/new-york/blocks/auth/auth-change-password.tsx",
      "content": "\"use client\";\n\nimport { CheckCircle2, Eye, EyeOff, Loader2, Lock, Shield } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/registry/new-york/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/registry/new-york/ui/card\";\nimport {\n  Field,\n  FieldContent,\n  FieldDescription,\n  FieldError,\n  FieldLabel,\n} from \"@/registry/new-york/ui/field\";\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput,\n} from \"@/registry/new-york/ui/input-group\";\n\nexport interface AuthChangePasswordProps {\n  onSubmit?: (data: { currentPassword: string; newPassword: string }) => void;\n  className?: string;\n  isLoading?: boolean;\n  isSuccess?: boolean;\n  errors?: {\n    currentPassword?: string;\n    newPassword?: string;\n    confirmPassword?: string;\n    general?: string;\n  };\n  successMessage?: string;\n}\n\nexport default function AuthChangePassword({\n  onSubmit,\n  className,\n  isLoading = false,\n  isSuccess = false,\n  errors,\n  successMessage = \"Your password has been changed successfully.\",\n}: AuthChangePasswordProps) {\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [localErrors, setLocalErrors] = useState<{\n    currentPassword?: string;\n    newPassword?: string;\n    confirmPassword?: string;\n  }>({});\n\n  const validateCurrentPassword = (value: string): string | undefined => {\n    if (!value) {\n      return \"Current password is required\";\n    }\n    return;\n  };\n\n  const validateNewPassword = (value: string): string | undefined => {\n    if (!value) {\n      return \"New password is required\";\n    }\n    if (value.length < 8) {\n      return \"Password must be at least 8 characters\";\n    }\n    if (!/(?=.*[a-z])/.test(value)) {\n      return \"Password must contain at least one lowercase letter\";\n    }\n    if (!/(?=.*[A-Z])/.test(value)) {\n      return \"Password must contain at least one uppercase letter\";\n    }\n    if (!/(?=.*\\d)/.test(value)) {\n      return \"Password must contain at least one number\";\n    }\n    if (value === currentPassword) {\n      return \"New password must be different from current password\";\n    }\n    return;\n  };\n\n  const validateConfirmPassword = (\n    value: string,\n    passwordValue: string\n  ): string | undefined => {\n    if (!value) {\n      return \"Please confirm your password\";\n    }\n    if (value !== passwordValue) {\n      return \"Passwords do not match\";\n    }\n    return;\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n\n    const currentPasswordError = validateCurrentPassword(currentPassword);\n    const newPasswordError = validateNewPassword(newPassword);\n    const confirmPasswordError = validateConfirmPassword(\n      confirmPassword,\n      newPassword\n    );\n\n    if (currentPasswordError || newPasswordError || confirmPasswordError) {\n      setLocalErrors({\n        currentPassword: currentPasswordError,\n        newPassword: newPasswordError,\n        confirmPassword: confirmPasswordError,\n      });\n      return;\n    }\n\n    setLocalErrors({});\n    onSubmit?.({\n      currentPassword,\n      newPassword,\n    });\n  };\n\n  const handleCurrentPasswordChange = (\n    e: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    const value = e.target.value;\n    setCurrentPassword(value);\n    if (localErrors.currentPassword) {\n      setLocalErrors((prev) => ({\n        ...prev,\n        currentPassword: validateCurrentPassword(value),\n      }));\n    }\n  };\n\n  const handleNewPasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setNewPassword(value);\n    if (localErrors.newPassword) {\n      setLocalErrors((prev) => ({\n        ...prev,\n        newPassword: validateNewPassword(value),\n      }));\n    }\n    if (localErrors.confirmPassword && confirmPassword) {\n      setLocalErrors((prev) => ({\n        ...prev,\n        confirmPassword: validateConfirmPassword(confirmPassword, value),\n      }));\n    }\n  };\n\n  const handleConfirmPasswordChange = (\n    e: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    const value = e.target.value;\n    setConfirmPassword(value);\n    if (localErrors.confirmPassword) {\n      setLocalErrors((prev) => ({\n        ...prev,\n        confirmPassword: validateConfirmPassword(value, newPassword),\n      }));\n    }\n  };\n\n  const currentPasswordError =\n    errors?.currentPassword || localErrors.currentPassword;\n  const newPasswordError = errors?.newPassword || localErrors.newPassword;\n  const confirmPasswordError =\n    errors?.confirmPassword || localErrors.confirmPassword;\n  const generalError = errors?.general;\n\n  if (isSuccess) {\n    return (\n      <Card className={cn(\"w-full shadow-xs\", className)}>\n        <CardHeader>\n          <CardTitle>Password changed</CardTitle>\n          <CardDescription>Your password has been updated</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-col items-center gap-4 rounded-lg border border-primary/20 bg-primary/5 p-6 text-center\">\n            <div className=\"flex size-12 items-center justify-center rounded-full bg-primary/10\">\n              <CheckCircle2 className=\"size-6 text-primary\" />\n            </div>\n            <p className=\"font-medium text-sm\">{successMessage}</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className={cn(\"w-full shadow-xs\", className)}>\n      <CardHeader>\n        <CardTitle>Change password</CardTitle>\n        <CardDescription>\n          Update your password to keep your account secure\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <form className=\"flex flex-col gap-6\" onSubmit={handleSubmit}>\n          {generalError && (\n            <div\n              aria-live=\"polite\"\n              className=\"rounded-lg border border-destructive/50 bg-destructive/10 p-3 text-destructive text-sm\"\n              role=\"alert\"\n            >\n              {generalError}\n            </div>\n          )}\n\n          <div className=\"flex flex-col gap-4\">\n            <Field data-invalid={!!currentPasswordError}>\n              <FieldLabel htmlFor=\"change-current-password\">\n                Current password\n                <span aria-label=\"required\" className=\"text-destructive\">\n                  *\n                </span>\n              </FieldLabel>\n              <FieldContent>\n                <InputGroup aria-invalid={!!currentPasswordError}>\n                  <InputGroupAddon>\n                    <Lock className=\"size-4\" />\n                  </InputGroupAddon>\n                  <InputGroupInput\n                    aria-describedby={\n                      currentPasswordError\n                        ? \"change-current-password-error\"\n                        : undefined\n                    }\n                    aria-invalid={!!currentPasswordError}\n                    autoComplete=\"current-password\"\n                    id=\"change-current-password\"\n                    name=\"currentPassword\"\n                    onChange={handleCurrentPasswordChange}\n                    placeholder=\"Enter current password\"\n                    required\n                    type={showCurrentPassword ? \"text\" : \"password\"}\n                    value={currentPassword}\n                  />\n                  <InputGroupButton\n                    aria-label={\n                      showCurrentPassword\n                        ? \"Hide current password\"\n                        : \"Show current password\"\n                    }\n                    onClick={(e) => {\n                      e.preventDefault();\n                      setShowCurrentPassword((prev) => !prev);\n                    }}\n                    type=\"button\"\n                  >\n                    {showCurrentPassword ? (\n                      <EyeOff className=\"size-4\" />\n                    ) : (\n                      <Eye className=\"size-4\" />\n                    )}\n                  </InputGroupButton>\n                </InputGroup>\n                {currentPasswordError && (\n                  <FieldError id=\"change-current-password-error\">\n                    {currentPasswordError}\n                  </FieldError>\n                )}\n              </FieldContent>\n            </Field>\n\n            <Field data-invalid={!!newPasswordError}>\n              <FieldLabel htmlFor=\"change-new-password\">\n                New password\n                <span aria-label=\"required\" className=\"text-destructive\">\n                  *\n                </span>\n              </FieldLabel>\n              <FieldContent>\n                <InputGroup aria-invalid={!!newPasswordError}>\n                  <InputGroupAddon>\n                    <Shield className=\"size-4\" />\n                  </InputGroupAddon>\n                  <InputGroupInput\n                    aria-describedby={\n                      newPasswordError ? \"change-new-password-error\" : undefined\n                    }\n                    aria-invalid={!!newPasswordError}\n                    autoComplete=\"new-password\"\n                    id=\"change-new-password\"\n                    name=\"newPassword\"\n                    onChange={handleNewPasswordChange}\n                    placeholder=\"Enter new password\"\n                    required\n                    type={showNewPassword ? \"text\" : \"password\"}\n                    value={newPassword}\n                  />\n                  <InputGroupButton\n                    aria-label={\n                      showNewPassword\n                        ? \"Hide new password\"\n                        : \"Show new password\"\n                    }\n                    onClick={(e) => {\n                      e.preventDefault();\n                      setShowNewPassword((prev) => !prev);\n                    }}\n                    type=\"button\"\n                  >\n                    {showNewPassword ? (\n                      <EyeOff className=\"size-4\" />\n                    ) : (\n                      <Eye className=\"size-4\" />\n                    )}\n                  </InputGroupButton>\n                </InputGroup>\n                {newPasswordError && (\n                  <FieldError id=\"change-new-password-error\">\n                    {newPasswordError}\n                  </FieldError>\n                )}\n                <FieldDescription>\n                  Must be at least 8 characters with uppercase, lowercase, and\n                  number\n                </FieldDescription>\n              </FieldContent>\n            </Field>\n\n            <Field data-invalid={!!confirmPasswordError}>\n              <FieldLabel htmlFor=\"change-confirm-password\">\n                Confirm new password\n                <span aria-label=\"required\" className=\"text-destructive\">\n                  *\n                </span>\n              </FieldLabel>\n              <FieldContent>\n                <InputGroup aria-invalid={!!confirmPasswordError}>\n                  <InputGroupAddon>\n                    <Lock className=\"size-4\" />\n                  </InputGroupAddon>\n                  <InputGroupInput\n                    aria-describedby={\n                      confirmPasswordError\n                        ? \"change-confirm-password-error\"\n                        : undefined\n                    }\n                    aria-invalid={!!confirmPasswordError}\n                    autoComplete=\"new-password\"\n                    id=\"change-confirm-password\"\n                    name=\"confirmPassword\"\n                    onChange={handleConfirmPasswordChange}\n                    placeholder=\"Confirm new password\"\n                    required\n                    type={showConfirmPassword ? \"text\" : \"password\"}\n                    value={confirmPassword}\n                  />\n                  <InputGroupButton\n                    aria-label={\n                      showConfirmPassword\n                        ? \"Hide confirm password\"\n                        : \"Show confirm password\"\n                    }\n                    onClick={(e) => {\n                      e.preventDefault();\n                      setShowConfirmPassword((prev) => !prev);\n                    }}\n                    type=\"button\"\n                  >\n                    {showConfirmPassword ? (\n                      <EyeOff className=\"size-4\" />\n                    ) : (\n                      <Eye className=\"size-4\" />\n                    )}\n                  </InputGroupButton>\n                </InputGroup>\n                {confirmPasswordError && (\n                  <FieldError id=\"change-confirm-password-error\">\n                    {confirmPasswordError}\n                  </FieldError>\n                )}\n              </FieldContent>\n            </Field>\n          </div>\n\n          <Button\n            aria-busy={isLoading}\n            className=\"w-full\"\n            data-loading={isLoading}\n            disabled={isLoading}\n            type=\"submit\"\n          >\n            {isLoading ? (\n              <>\n                <Loader2 className=\"size-4 animate-spin\" />\n                Updating passwordâ€¦\n              </>\n            ) : (\n              <>\n                <Shield className=\"size-4\" />\n                Update password\n              </>\n            )}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n",
      "type": "registry:ui"
    }
  ]
}
