{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "auth-recovery-codes",
  "type": "registry:ui",
  "title": "Auth Recovery Codes",
  "description": "Display and manage two-factor authentication recovery codes.",
  "registryDependencies": ["alert-dialog", "button", "card"],
  "files": [
    {
      "path": "registry/new-york/blocks/auth/auth-recovery-codes.tsx",
      "content": "\"use client\";\n\nimport {\n  AlertTriangle,\n  CheckCircle2,\n  Copy,\n  Download,\n  Eye,\n  EyeOff,\n  Loader2,\n  RefreshCw,\n  Shield,\n} from \"lucide-react\";\nimport { useCallback, useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/registry/new-york/ui/alert-dialog\";\nimport { Button } from \"@/registry/new-york/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/registry/new-york/ui/card\";\n\nexport interface AuthRecoveryCodesProps {\n  codes?: string[];\n  onGenerate?: () => void;\n  onRegenerate?: () => void;\n  className?: string;\n  isLoading?: boolean;\n  errors?: {\n    general?: string;\n  };\n}\n\nexport default function AuthRecoveryCodes({\n  codes = [],\n  onGenerate,\n  onRegenerate,\n  className,\n  isLoading = false,\n  errors,\n}: AuthRecoveryCodesProps) {\n  const [showCodes, setShowCodes] = useState(false);\n  const [copiedIndex, setCopiedIndex] = useState<number | null>(null);\n  const [isRegenerating, setIsRegenerating] = useState(false);\n\n  const handleCopyCode = useCallback(async (code: string, index: number) => {\n    try {\n      await navigator.clipboard.writeText(code);\n      setCopiedIndex(index);\n      setTimeout(() => setCopiedIndex(null), 2000);\n    } catch {}\n  }, []);\n\n  const handleCopyAll = useCallback(async () => {\n    if (codes.length === 0) return;\n    try {\n      await navigator.clipboard.writeText(codes.join(\"\\n\"));\n    } catch {}\n  }, [codes]);\n\n  const handleDownload = useCallback(() => {\n    if (codes.length === 0) return;\n    const content = codes.join(\"\\n\");\n    const blob = new Blob([content], { type: \"text/plain\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"recovery-codes.txt\";\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }, [codes]);\n\n  const handleRegenerate = useCallback(async () => {\n    setIsRegenerating(true);\n    try {\n      await onRegenerate?.();\n      setShowCodes(true);\n    } finally {\n      setIsRegenerating(false);\n    }\n  }, [onRegenerate]);\n\n  const generalError = errors?.general;\n\n  if (codes.length === 0 && !onGenerate) {\n    return (\n      <Card className={cn(\"w-full shadow-xs\", className)}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Shield className=\"size-5\" />\n            Recovery codes\n          </CardTitle>\n          <CardDescription>\n            Backup codes for two-factor authentication\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-col items-center justify-center py-8 text-center\">\n            <p className=\"text-muted-foreground text-sm\">\n              No recovery codes available. Generate codes to get started.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className={cn(\"w-full shadow-xs\", className)}>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Shield className=\"size-5\" />\n              Recovery codes\n            </CardTitle>\n            <CardDescription>\n              Save these codes in a safe place. You can use them to access your\n              account if you lose your authenticator device.\n            </CardDescription>\n          </div>\n          {codes.length === 0 && onGenerate && (\n            <Button\n              aria-busy={isLoading}\n              data-loading={isLoading}\n              disabled={isLoading}\n              onClick={onGenerate}\n              type=\"button\"\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 className=\"size-4 animate-spin\" />\n                  Generating…\n                </>\n              ) : (\n                <>\n                  <RefreshCw className=\"size-4\" />\n                  Generate codes\n                </>\n              )}\n            </Button>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"flex flex-col gap-6\">\n          {generalError && (\n            <div\n              aria-live=\"polite\"\n              className=\"rounded-lg border border-destructive/50 bg-destructive/10 p-3 text-destructive text-sm\"\n              role=\"alert\"\n            >\n              {generalError}\n            </div>\n          )}\n\n          {codes.length > 0 ? (\n            <>\n              <div className=\"rounded-lg border border-yellow-500/50 bg-yellow-500/5 p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <AlertTriangle className=\"size-5 shrink-0 text-yellow-600\" />\n                  <div className=\"flex flex-1 flex-col gap-1\">\n                    <p className=\"font-medium text-sm text-yellow-900 dark:text-yellow-100\">\n                      Important: Save these codes\n                    </p>\n                    <p className=\"text-xs text-yellow-800 dark:text-yellow-200\">\n                      Store these recovery codes in a secure location. Each code\n                      can only be used once. If you lose access to your\n                      authenticator app, these codes are your only way to access\n                      your account.\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex flex-col gap-3\">\n                <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n                  <h3 className=\"font-medium text-sm\">Your recovery codes</h3>\n                  <Button\n                    className=\"w-full sm:w-auto\"\n                    onClick={() => setShowCodes(!showCodes)}\n                    type=\"button\"\n                    variant=\"ghost\"\n                  >\n                    {showCodes ? (\n                      <>\n                        <EyeOff className=\"size-4\" />\n                        Hide codes\n                      </>\n                    ) : (\n                      <>\n                        <Eye className=\"size-4\" />\n                        Show codes\n                      </>\n                    )}\n                  </Button>\n                </div>\n\n                {showCodes ? (\n                  <div className=\"grid grid-cols-1 gap-2 rounded-lg border bg-background p-4 sm:grid-cols-2\">\n                    {codes.map((code, index) => (\n                      <div\n                        className=\"flex items-center justify-between gap-2 rounded-md border bg-muted/50 p-2 font-mono text-sm\"\n                        key={index}\n                      >\n                        <span className=\"flex-1\">{code}</span>\n                        <Button\n                          aria-label={`Copy recovery code ${index + 1}`}\n                          onClick={() => handleCopyCode(code, index)}\n                          size=\"icon-sm\"\n                          type=\"button\"\n                          variant=\"ghost\"\n                        >\n                          {copiedIndex === index ? (\n                            <CheckCircle2 className=\"size-3.5 text-primary\" />\n                          ) : (\n                            <Copy className=\"size-3.5\" />\n                          )}\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"grid grid-cols-1 gap-2 rounded-lg border bg-background p-4 sm:grid-cols-2\">\n                    {codes.map((_, index) => (\n                      <div\n                        className=\"flex items-center justify-between gap-2 rounded-md border bg-muted/50 p-2\"\n                        key={index}\n                      >\n                        <span className=\"font-mono text-sm\">\n                          {Array.from({ length: 8 })\n                            .map(() => \"•\")\n                            .join(\"\")}\n                        </span>\n                        <Copy className=\"size-3.5 text-muted-foreground\" />\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                <div className=\"flex flex-col gap-2 sm:flex-row sm:flex-wrap\">\n                  <Button\n                    className=\"w-full sm:w-auto\"\n                    onClick={handleCopyAll}\n                    type=\"button\"\n                    variant=\"outline\"\n                  >\n                    <Copy className=\"size-4\" />\n                    Copy all codes\n                  </Button>\n                  <Button\n                    className=\"w-full sm:w-auto\"\n                    onClick={handleDownload}\n                    type=\"button\"\n                    variant=\"outline\"\n                  >\n                    <Download className=\"size-4\" />\n                    Download codes\n                  </Button>\n                  {onRegenerate && (\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button\n                          aria-busy={isRegenerating}\n                          className=\"w-full sm:w-auto\"\n                          data-loading={isRegenerating}\n                          disabled={isRegenerating}\n                          type=\"button\"\n                          variant=\"outline\"\n                        >\n                          {isRegenerating ? (\n                            <>\n                              <Loader2 className=\"size-4 animate-spin\" />\n                              Regenerating…\n                            </>\n                          ) : (\n                            <>\n                              <RefreshCw className=\"size-4\" />\n                              Regenerate codes\n                            </>\n                          )}\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>\n                            Regenerate recovery codes?\n                          </AlertDialogTitle>\n                          <AlertDialogDescription>\n                            This will invalidate all existing recovery codes and\n                            generate new ones. Make sure to save the new codes\n                            in a secure location. This action cannot be undone.\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel>Cancel</AlertDialogCancel>\n                          <AlertDialogAction\n                            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                            onClick={handleRegenerate}\n                          >\n                            Regenerate codes\n                          </AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex flex-col items-center justify-center gap-4 rounded-lg border bg-muted/50 p-8 text-center\">\n              <div className=\"flex size-12 items-center justify-center rounded-full bg-muted\">\n                <Shield className=\"size-6 text-muted-foreground\" />\n              </div>\n              <div className=\"flex flex-col gap-2\">\n                <p className=\"font-medium text-sm\">\n                  No recovery codes generated\n                </p>\n                <p className=\"text-muted-foreground text-xs\">\n                  Generate recovery codes to use as a backup for two-factor\n                  authentication\n                </p>\n              </div>\n              {onGenerate && (\n                <Button\n                  aria-busy={isLoading}\n                  data-loading={isLoading}\n                  disabled={isLoading}\n                  onClick={onGenerate}\n                  type=\"button\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"size-4 animate-spin\" />\n                      Generating…\n                    </>\n                  ) : (\n                    <>\n                      <RefreshCw className=\"size-4\" />\n                      Generate recovery codes\n                    </>\n                  )}\n                </Button>\n              )}\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n",
      "type": "registry:ui"
    }
  ]
}
